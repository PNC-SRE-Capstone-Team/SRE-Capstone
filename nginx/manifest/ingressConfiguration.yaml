#nginx/ingressConfiguration.yaml
ingress-nginx:
  apiVersion: networking.k8s.io/v1
  kind: Ingress
  metadata:
    name: wildcard-ingress
    namespace: ingress-nginx
    annotations:
      kubernetes.io/ingress.class: "nginx"
      nginx.ingress.kubernetes.io/force-ssl-redirect: "true"
      nginx.ingress.kubernetes.io/ssl-redirect: "true"
      nginx.ingress.kubernetes.io/rewrite-target: /
      nginx.ingress.kubernetes.io/proxy-body-size: "10m"
  spec:
    tls:
      - hosts:
          - "*.damdiel.com"  # Wildcard domain for all services
        secretName: wildcard-cert-tls
    rules:
      - host: argocd.damdiel.com
        http:
          paths:
            - path: /
              pathType: Prefix
              backend:
                service:
                  name: argo-cd-argocd-server.argo-cd.svc.cluster.local
                  port:
                    number: 30443
      - host: grafana.damdiel.com
        http:
          paths:
            - path: /
              pathType: Prefix
              backend:
                service:
                  name: grafana
                  port:
                    number: 30444
      - host: kafka.damdiel.com
        http:
          paths:
            - path: /
              pathType: Prefix
              backend:
                service:
                  name: kafka-controller-0-external
                  port:
                    number: 9094
      - host: mariadb.damdiel.com
        http:
          paths:
            - path: /
              pathType: Prefix
              backend:
                service:
                  name: mariadb
                  port:
                    number: 30446
      - host: mongodb.damdiel.com
        http:
          paths:
            - path: /
              pathType: Prefix
              backend:
                service:
                  name: mongodb
                  port:
                    number: 30445
      - host: mongodb-metrics.damdiel.com
        http:
          paths:
            - path: /
              pathType: Prefix
              backend:
                service:
                  name: mongodb-metrics
                  port:
                    number: 9216
      - host: prometheus.damdiel.com
        http:
          paths:
            - path: /
              pathType: Prefix
              backend:
                service:
                  name: prometheus
                  port:
                    number: 9104
